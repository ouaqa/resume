function _visibilityInstance(){this.element=null,this.callback=null,this.dispatchOnce=!1}function _visibilityManager(){"use strict";this.visibilityInstancesList=Array(),this._isTicking=!1,this._latestScrollY=window.pageYOffset||window.document.documentElement.scrollTop,this._viewedHeight=this._latestScrollY+toolBox.getViewPortHeight()}var visibilityManager=new _visibilityManager;window.visibilityManager=visibilityManager,_visibilityManager.prototype.isVisible=function(t,e){"use strict";var i=t.offsetHeight,n=this._latestScrollY,a=this._viewedHeight,s=toolBox.getAbsoluteOffset(t).top,l=s+i,e=e||0;return a>=s+i*e&&l-i*e>=n},_visibilityManager.prototype._requestTick=function(){"use strict";0==this._isTicking&&requestAnimationFrame(this._updateVisibility),this._isTicking=!0},_visibilityManager.prototype._refreshValues=function(){"use strict";window.visibilityManager._latestScrollY=window.pageYOffset||window.document.documentElement.scrollTop,window.visibilityManager._requestTick()},_visibilityManager.prototype._updateVisibility=function(){"use strict";var t=window.visibilityManager,e=t.visibilityInstancesList.length,i=null,n=0,a=null;if(e>0)for(t._viewedHeight=t._latestScrollY+toolBox.getViewPortHeight();e>n;)i=t.visibilityInstancesList[n],a=i.element,t.isVisible(a)&&(i.callback(a),i.dispatchOnce&&(t.visibilityInstancesList.remove(n),n--,e--)),i=null,a=null,n++;i=null,a=null,0==t.visibilityInstancesList&&t._detachVisibilityHandler(),t._isTicking=!1},_visibilityManager.prototype.addOnce=function(t,e){"use strict";var i=new _visibilityInstance;i.element=t,i.callback=e,i.dispatchOnce=!0,this._attachVisibilityHandler(i.handler),this.visibilityInstancesList.push(i),1==this.visibilityInstancesList&&(this._detachVisibilityHandler(),this._attachVisibilityHandler()),i=null},_visibilityManager.prototype.add=function(t,e){"use strict";var i=new _visibilityInstance;i.element=t,i.callback=e,i.dispatchOnce=!1,this._attachVisibilityHandler(i.handler),this.visibilityInstancesList.push(i),1==this.visibilityInstancesList&&(this._detachVisibilityHandler(),this._attachVisibilityHandler()),i=null},_visibilityManager.prototype.remove=function(t){"use strict";var e=this.visibilityInstancesList.length,i=null;if(e>0)for(var n=0,a=!1;e>n&&0==a;){if(i=this.visibilityInstancesList[n],i.element===t){a=!0,this.visibilityInstancesList.remove(n);break}n++}0==this.visibilityInstancesList&&this._detachVisibilityHandler(),i=null},_visibilityManager.prototype._attachVisibilityHandler=function(){"use strict";window.addEventListener?(addEventListener("DOMContentLoaded",this._refreshValues,!1),addEventListener("load",this._refreshValues,!1),addEventListener("scroll",this._refreshValues,!1),addEventListener("resize",this._refreshValues,!1)):window.attachEvent&&(attachEvent("onDOMContentLoaded",this._refreshValues),attachEvent("onload",this._refreshValues),attachEvent("onscroll",this._refreshValues),attachEvent("onresize",this._refreshValues))},_visibilityManager.prototype._detachVisibilityHandler=function(){"use strict";window.addEventListener?(removeEventListener("DOMContentLoaded",this._refreshValues,!1),removeEventListener("load",this._refreshValues,!1),removeEventListener("scroll",this._refreshValues,!1),removeEventListener("resize",this._refreshValues,!1)):window.attachEvent&&(detachEvent("onDOMContentLoaded",this._refreshValues),detachEvent("onload",this._refreshValues),detachEvent("onscroll",this._refreshValues),detachEvent("onresize",this._refreshValues))};